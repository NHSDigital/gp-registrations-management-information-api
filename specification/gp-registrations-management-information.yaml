openapi: "3.0.0"
x-nhs-api-spec-guid: 4631c387-3793-4413-8c61-395e014864b2
x-meta:
  service_name: "gp-registrations-management-information"
  short_service_name: "gprmi"
  product_display_name: "GP Registrations Management Information API"
  service_base_path: "gp-registrations-mi"
  product_description: "An API to capture GP Registrations management information (MI)"
  pipeline_name_prefix: "GP-Registrations-Management-Information"
info:
  version: 0.0.1
  title: GP Registrations Management Information API
  description: |
    ## Overview
    Use this API to send real-time management information about GP registrations to us at NHS Digital.
    This API can receive Management Information from GP practices using either the GP2GP or GP Connect protocols.

    ### GP2GP

    Using this protocol you can send us information about the following type of events:
    * when the requesting practice starts the GP2GP registration - the first message initiated as part of the GP2GP protocol
    * when the sending practice generates the electronic health record
    * when the requesting practice requests an EHR
    * when the sending practice sends an EHR
    * when the requesting practice validates an EHR
    * when the requesting practice integrates an EHR
    * when the requesting practice has completed the GP2GP registration

    ### GP Connect

    Using this protocol you can send us information about the following type of events:
    * when the requesting practice starts the GP2GP registration - the first message initiated as part of the GP Connect protocol
    * when the request is sent to migrate the structured record
    * when the response has been received from migrating the structured record
    * when a request is sent to migrate a document
    * when a response has been received from migrating a document
    * when the EHR is ready to integrate
    * when the EHR has been integrated
    * when the registration has been completed
    * when an internal transfer of an EHR has been completed between two GP practices using the same software supplier system
    * when an error occurs

    You cannot:
    * read any management information data submitted to us

    This API replaces the weekly submission of GP2GP information sent to us via a MESH mailbox, as required by [GP2GP V2.2b](https://nhsconnect.github.io/prm-external-developer-website/gp2gp/gp2gp_2.2b/overview/).

    ## Who can use this API
    This API can only be used where there is a legal basis to do so. Make sure you have a valid use case before you go too far with your development.
    You must do this before you can go live (see ‘Onboarding’ below). 

    ## Related APIs
    Use [GP2GP - HL7 API](https://digital.nhs.uk/developer/api-catalogue/gp2gp) to learn more the GP2GP protocol.

    Use the following to learn more about the GP Connect protocol:
    * [GP Connect Access Document - FHIR API](https://digital.nhs.uk/developer/api-catalogue/gp-connect-access-document-fhir)
    * [GP Connect Access Record: HTML - FHIR API](https://digital.nhs.uk/developer/api-catalogue/gp-connect-access-record-html-fhir)
    * [GP Connect Access Record: Structured - FHIR API](https://digital.nhs.uk/developer/api-catalogue/gp-connect-access-record-structured-fhir)
    * [GP Connect Send Document - FHIR API](https://digital.nhs.uk/developer/api-catalogue/gp-connect-send-document-fhir)

    ## API status
    This API is in [alpha](https://digital.nhs.uk/developer/guides-and-documentation/reference-guide#api-status)

    ## Service level
    This API is a silver service, meaning it is operational 24 x 7 x 365 but only supported during business hours (8am to 6pm), Monday to Friday excluding bank holidays.
    For more details, see [service levels](https://digital.nhs.uk/developer/guides-and-documentation/reference-guide#service-levels).

    ## Technology
    This API uses HTTP POST to submit data.

    ## Network access
    This API is only available on the internet. For more details, see [Network access for APIs](https://digital.nhs.uk/developer/guides-and-documentation/network-access-for-apis#internet-only-apis).

    ## Security and authorisation

    The access mode is [application-restricted](https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation#application-restricted-apis),
    meaning we authenticate the calling application but not the end user.
    To use this access mode, use the following security pattern:
    * [Application-restricted RESTful APIs - API key authentication](https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation/application-restricted-restful-apis-api-key-authentication)

    ## Environments and testing

    | Environment       | Base URL                                                               |
    | ----------------- | ---------------------------------------------------------------------- |
    | Integration test  | `https://int.api.service.nhs.uk/gp-registrations-mi/`                  |
    | Production        | `https://api.service.nhs.uk/gp-registrations-mi/`                      |


    ### Integration testing
    Our [integration test environment](https://digital.nhs.uk/developer/guides-and-documentation/testing#integration-testing):
    * is for formal integration testing or early developer testing
    * includes authorisation

    ## Onboarding
    You need to get your software approved by us before it can go live with this API. We call this onboarding. The onboarding process can sometimes be quite long, so it’s worth planning well ahead. More details on the onboarding process to follow.

  license:
    name: MIT
  contact:
    url: 'https://nhsconnect.github.io/prm-external-developer-website/rfcs/'
    email: ian.griffiths12@nhs.net

tags:
  - name: GP Connect
    description: Endpoints to submit events for the GP Connect protocol
  - name: GP2GP
    description: Endpoints to submit events for the GP2GP protocol

x-spec-publication:
  operation-order:
    - group: GP2GP
      operations:
        - method: POST
          path: /gp2gp/registrationStarted
        - method: POST
          path: /gp2gp/ehrRequested
        - method: POST
          path: /gp2gp/ehrGenerated
        - method: POST
          path: /gp2gp/ehrSent
        - method: POST
          path: /gp2gp/ehrValidated
        - method: POST
          path: /gp2gp/ehrIntegrated
        - method: POST
          path: /gp2gp/registrationCompleted
    - group: GP Connect
      operations:
        - method: POST
          path: /gpconnect/registrationStarted
        - method: POST
          path: /gpconnect/migrateStructuredRecordRequest
        - method: POST
          path: /gpconnect/migrateStructuredRecordResponse
        - method: POST
          path: /gpconnect/migrateDocumentRequest
        - method: POST
          path: /gpconnect/migrateDocumentResponse
        - method: POST
          path: /gpconnect/ehrReadyToIntegrate
        - method: POST
          path: /gpconnect/ehrIntegrated
        - method: POST
          path: /gpconnect/registrationCompleted
        - method: POST
          path: /gpconnect/internalTransfer
        - method: POST
          path: /gpconnect/error

paths:
  /gp2gp/registrationStarted:
    post:
      tags:
        - GP2GP
      summary: Submit registration started event
      operationId: registrationStarted
      description: |
        Use this endpoint to submit GP registration management information for when a registration is started.

        ### Request Body example:
        ```json
        {
          "eventId": "1234-1234-1234-1234",
          "eventGeneratedDateTime": "2020-02-08T09:30:26Z",
          "registrationId": "6235-123456-8947-127834",
          "reportingSystemSupplier": "EMIS",
          "reportingPracticeOdsCode": "ABC1234",
          "payload": {
            "registration": {
              "registrationStartedDateTime": "2020-02-08T08:30:26Z",
              "registrationType": "newRegistrant",
              "requestingPracticeOdsCode": "ABC1234"
            }
          }
        }
        ```
      parameters:
        - in: header
          name: apikey
          description: API key to authenticate with.
          schema:
            type: string
          required: true
      requestBody:
        description: |
          The request body required for the registration started event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          type: object
                          description: An object that contains information about the registration process
                          properties:
                            registrationType:
                              type: string
                              description: The type of this registration (newRegistrant, etc...)
                              example: newRegistrant
                            registrationStartedDateTime:
                              type: string
                              description: The ISO 8601 Date time in UTC of when the registration started
                              example: 2020-02-08T08:30:26Z
                            requestingPracticeOdsCode:
                              type: string
                              description: The ODS code of the practice requesting the EHR
                              example: ABC1234
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /gp2gp/ehrRequested:
    post:
      tags:
        - GP2GP
      summary: Submit EHR requested event
      operationId: ehrRequested
      description: |
        Use this endpoint to submit GP registration management information for when an Electronic Health Record (EHR) is requested:

        ### Request Body example:
        ```json
        {
          "eventId": "1234-1234-1234-1234",
          "eventGeneratedDateTime": "2020-02-08T09:30:26Z",
          "registrationId": "9087-978098-9087-978098",
          "reportingSystemSupplier": "EMIS",
          "reportingPracticeOdsCode": "ABC1234",
          "payload": {
            "registration": {
              "requestingPracticeOdsCode": "ABC1234",
              "sendingPracticeOdsCode": "XYZ4567"
            },
            "gpTransferMetadata": {
              "conversationId": "4345-986959-4930-684038",
              "transferEventDateTime": "2020-02-08T08:30:25Z"
            }
          }
        }
        ```
      parameters:
        - in: header
          name: apikey
          description: API key to authenticate with.
          schema:
            type: string
          required: true
      requestBody:
        description: The request body required for the EHR requested event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /gp2gp/ehrGenerated:
    post:
      tags:
        - GP2GP
      summary: Submit EHR generated event
      operationId: ehrGenerated
      description: |
        Use this endpoint to submit GP registration management information for when an Electronic Health Record (EHR) is generated.

        ### Request Body example:
        ```json
        {
          "eventId": "1234-123456-1234-123451",
          "eventGeneratedDateTime": "2020-02-08T09:30:26Z",
          "registrationId": "9087-978098-9087-978098",
          "reportingSystemSupplier": "SYSTEM_SUPPLIER",
          "reportingPracticeOdsCode": "XYZ4567",
          "payload": {
            "registration": {
              "requestingPracticeOdsCode": "ABC1234",
              "sendingPracticeOdsCode": "XYZ4567"
            },
            "gpTransferMetadata": {
              "conversationId": "4345-986959-4930-684038",
              "transferEventDateTime": "2020-02-08T09:30:26Z"
            },
            "ehr": {
              "ehrTotalSizeBytes": 5699433,
              "ehrStructuredSizeBytes": 4096,
              "attachment": [
                {
                  "attachmentId": "3424-342456-3424-342456",
                  "clinicalType": "Scanned document",
                  "mimeType": "application/pdf",
                  "sizeBytes": 3084322
                },
                {
                  "attachmentId": "1323-132345-1323-132345",
                  "mimeType": "audio/mpeg",
                  "sizeBytes": 24352346
                }
              ],
              "placeholder": [
                {
                  "placeholderId": "9876-987654-9876-987654",
                  "attachmentId": "1323-132345-1323-132345",
                  "generatedBy": "XYZ4567",
                  "reason": 1,
                  "originalMimeType": "audio/mpeg"
                }
              ]
            },
            "unsupportedDataItem": [
              {
                "type": "allergy/flag",
                "uniqueIdentifier": "1323-132345-1323-132345",
                "reason": "reason for being unsupported / why is it unsupported in gp2gp / what would have to change in gp2gp to express this"
              }
            ]
          }
        }
        ```
      parameters:
        - in: header
          name: apikey
          description: API key to authenticate with.
          schema:
            type: string
          required: true
      requestBody:
        description: The request body required for the EHR generated event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        ehr:
                          properties:
                            ehrTotalSizeBytes:
                              type: integer
                              description: The total size in bytes of the GP2GP message BEFORE it is split for transfer including all attachments
                              example: 5699433
                            ehrStructuredSizeBytes:
                              type: integer
                              description: The total size in bytes of structured part of the GP2GP message (attachments are NOT to be included)
                              example: 4096
                            attachment:
                              type: array
                              description: A list that contains information about ALL the attachments contained in the EHR. This should include all attachments that are either directly attached OR that are linked to from within the EHR
                              items:
                                $ref: components/schemas/Attachment.yaml
                            placeholder:
                              type: array
                              description: A list that contains information about the attachments that were in the EHR but not contained in the GP2GP message
                              items:
                                $ref: components/schemas/Placeholder.yaml
                        unsupportedDataItem:
                          type: array
                          items:
                            $ref: components/schemas/UnsupportedDataItem.yaml
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /gp2gp/ehrSent:
    post:
      tags:
        - GP2GP
      summary: Submit EHR sent event
      operationId: ehrSent
      description: |
        Use this endpoint to submit GP registration management information for when an Electronic Health Record (EHR) is sent.

        ### Request Body example:
        ```json
        {
          "eventId": "1234-1234-1234-1234",
          "eventGeneratedDateTime": "2020-02-08T09:30:26Z",
          "registrationId": "9087-978098-9087-978098",
          "reportingSystemSupplier": "EMIS",
          "reportingPracticeOdsCode": "ABC1234",
          "payload": {
            "registration": {
              "requestingPracticeOdsCode": "ABC1234",
              "sendingPracticeOdsCode": "XYZ4567"
            },
            "gpTransferMetadata": {
              "conversationId": "4345-986959-4930-684038",
              "transferEventDateTime": "2020-02-08T08:30:25Z"
            }
          }
        }
        ```
      parameters:
        - in: header
          name: apikey
          description: API key to authenticate with.
          schema:
            type: string
          required: true
      requestBody:
        description: The request body required for the EHR sent event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /gp2gp/ehrValidated:
    post:
      tags:
        - GP2GP
      summary: Submit EHR validated event
      operationId: ehrValidated
      description: |
        Use this endpoint to submit GP registration management information for when an Electronic Health Record (EHR) is validated.

        ### Request Body example:
        ```json
        {
          "eventId": "1234-123456-1234-123451",
          "eventGeneratedDateTime": "2020-02-08T09:30:26Z",
          "registrationId": "9087-978098-9087-978098",
          "reportingSystemSupplier": "SYSTEM_SUPPLIER",
          "reportingPracticeOdsCode": "XYZ4567",
          "payload": {
            "registration": {
              "requestingPracticeOdsCode": "ABC1234",
              "sendingPracticeOdsCode": "XYZ4567"
            },
            "gpTransferMetadata": {
              "conversationId": "4345-986959-4930-684038",
              "transferEventDateTime": "2020-02-08T09:30:26Z"
            },
            "ehr": {
              "ehrTotalSizeBytes": 5699433,
              "ehrStructuredSizeBytes": 4096,
              "degrade": [
                {
                  "type": "core_ehr / attachment",
                  "metadata": "other degrades metadata",
                  "code": {
                    "coding": [
                      {
                        "code": "886721000000107",
                        "system": "http://snomed.info/sct"
                      }
                    ]
                  }
                }
              ],
              "attachment": [
                {
                  "attachmentId": "3424-342456-3424-342456",
                  "clinicalType": "Scanned document",
                  "mimeType": "application/pdf",
                  "sizeBytes": 3084322
                }
              ],
              "placeholder": [
                {
                  "placeholderId": "9876-987654-9876-987654",
                  "attachmentId": "1323-132345-1323-132345",
                  "generatedBy": "XYZ4567",
                  "reason": 1,
                  "originalMimeType": "audio/mpeg"
                },
                {
                  "placeholderId": "4354-435467-4354-435467",
                  "attachmentId": "3424-342456-3424-342456",
                  "generatedBy": "ABC1234",
                  "reason": 2,
                  "originalMimeType": "audio/mpeg"
                }
              ]
            }
          }
        }
        ```
      parameters:
        - in: header
          name: apikey
          description: API key to authenticate with.
          schema:
            type: string
          required: true
      requestBody:
        description: The request body required for the EHR validated event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        ehr:
                          properties:
                            ehrTotalSizeBytes:
                              type: integer
                              description: The total size in bytes of the GP2GP message as reconstituted by the receiving system including all attachments received
                              example: 5699433
                            ehrStructuredSizeBytes:
                              type: integer
                              description: The total size in bytes of structured part of the GP2GP message as received by the receiving system (attachments are NOT to be included)
                              example: 4096
                            attachment:
                              type: array
                              description: A list that contains information about ALL the attachments contained in the EHR. This should include all attachments that are either directly attached OR that are linked to from within the EHR
                              items:
                                $ref: components/schemas/Attachment.yaml
                            placeholder:
                              type: array
                              description: A list that contains information about the attachments that were in the EHR but not contained in the GP2GP message
                              items:
                                $ref: components/schemas/Placeholder.yaml
                            degrade:
                              type: array
                              description: A list that contains information about ALL the degrades contained in the EHR that occurred due to the gp2gp transfer
                              items:
                                $ref: components/schemas/Degrade.yaml
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /gp2gp/ehrIntegrated:
    post:
      tags:
        - GP2GP
      summary: Submit EHR integrated event
      operationId: ehrIntegrated
      description: |
        Use this endpoint to submit GP registration management information for when an Electronic Health Record (EHR) is integrated.

        ### Request Body example:
        ```json
        {
          "eventId": "1234-123456-1234-123451",
          "eventGeneratedDateTime": "2020-02-08T09:30:26Z",
          "registrationId": "9087-978098-9087-978098",
          "reportingSystemSupplier": "SYSTEM_SUPPLIER",
          "reportingPracticeOdsCode": "XYZ4567",
          "payload": {
            "registration": {
              "requestingPracticeOdsCode": "ABC1234",
              "sendingPracticeOdsCode": "XYZ4567"
            },
            "gpTransferMetadata": {
              "conversationId": "4345-986959-4930-684038",
              "transferEventDateTime": "2020-02-08T09:30:26Z"
            },
            "integration": {
              "integrationStatus": "filed as attachment/ suppressed/ merged/ rejected",
              "reason": "Reason for integration status"
            }
          }
        }
        ```
      parameters:
        - in: header
          name: apikey
          description: API key to authenticate with.
          schema:
            type: string
          required: true
      requestBody:
        description: The request body required for the EHR integrated event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        integration:
                          $ref: components/schemas/Integration.yaml
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /gp2gp/registrationCompleted:
    post:
      tags:
        - GP2GP
      summary: Submit Registration Completed event
      operationId: registrationCompleted
      description: |
        Use this endpoint to submit GP registration management information for when a GP2GP registration is complete.

        ### Request Body example:
        ```json
        {
          "eventId": "1234-1234-1234-1234",
          "eventGeneratedDateTime": "2020-02-08T09:30:26Z",
          "registrationId": "9087-978098-9087-978098",
          "reportingSystemSupplier": "EMIS",
          "reportingPracticeOdsCode": "ABC1234",
          "payload": {
            "registration": {
              "requestingPracticeOdsCode": "ABC1234",
              "sendingPracticeOdsCode": "XYZ4567"
            },
            "gpTransferMetadata": {
              "conversationId": "4345-986959-4930-684038",
              "transferEventDateTime": "2020-02-08T08:30:25Z"
            }
          }
        }
        ```
      parameters:
        - in: header
          name: apikey
          description: API key to authenticate with.
          schema:
            type: string
          required: true
      requestBody:
        description: The request body required for the registration completed event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /gpconnect/registrationStarted:
    post:
      tags:
        - GP Connect
      summary: Submit registration started event
      operationId: registrationStartedGC
      description: |
        Use this endpoint to submit GP registration management information for when a registration is started.

        ### Request Body example:
        ```json
        {
          "eventId": "1234-123456-1234-123454",
          "eventGeneratedDateTime": "2020-02-08T09:30:26Z",
          "registrationId": "9087-978098-9087-978098",
          "reportingSystemSupplier": "SYSTEM_SUPPLIER",
          "reportingPracticeOdsCode": "ABC1234",
          "payload": {
            "registration": {
              "registrationStartedDateTime": "2020-02-08T09:30:26Z",
              "requestingPracticeOdsCode": "ABC1234",
              "registrationType": "newRegistrant"
            }
          }
        }
        ```
      parameters:
        - in: header
          name: apikey
          description: API key to authenticate with.
          schema:
            type: string
          required: true
      requestBody:
        description: The request body required for the registration started event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          type: object
                          description: An object that contains information about the registration process
                          properties:
                            registrationType:
                              type: string
                              description: The type of this registration (newRegistrant, etc...)
                              example: newRegistrant
                            registrationStartedDateTime:
                              type: string
                              description: The ISO 8601 Date time in UTC of when the registration started
                              example: 2020-02-08T08:30:26Z
                            requestingPracticeOdsCode:
                              type: string
                              description: The ODS code of the practice requesting the EHR
                              example: ABC1234
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /gpconnect/migrateStructuredRecordRequest:
    post:
      tags:
        - GP Connect
      summary: Submit Migrate Structured Record Request event
      operationId: migrateStructuredRecordRequest
      description: |
        Use this endpoint to submit GP registration management information immediately after the Requesting System will make a request via GP Connect using the ‘Migrate Structured Record’ end point using the previous Health Care Provider code that was cached

        ### Request Body example:
        ```json
        {
          "eventId": "1234-1234-1234-1234",
          "eventGeneratedDateTime": "2020-02-08T09:30:26Z",
          "registrationId": "9087-978098-9087-978098",
          "reportingSystemSupplier": "EMIS",
          "reportingPracticeOdsCode": "ABC1234",
          "payload": {
            "registration": {
              "requestingPracticeOdsCode": "ABC1234",
              "sendingPracticeOdsCode": "XYZ4567"
            },
            "gpTransferMetadata": {
              "conversationId": "4345-986959-4930-684038",
              "transferEventDateTime": "2020-02-08T08:30:25Z"
            }
          }
        }
        ```
      parameters:
        - in: header
          name: apikey
          description: API key to authenticate with.
          schema:
            type: string
          required: true
      requestBody:
        description: The request body required for the migrate structured record request event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /gpconnect/migrateStructuredRecordResponse:
    post:
      tags:
        - GP Connect
      summary: Submit Migrate Structured Record response event
      operationId: migrateStructuredRecordResponse
      description: |
        Use this endpoint to submit GP registration management information immediately after the Requesting System has received a response from the request made via GP Connect using the ‘Migrate Structured Record’ end point. In a happy-path scenario, the response should contain the "Migrate Patient Record Bundle"
        ### Request Body example:
        ```json
        {
          "eventId": "1234-123456-1234-123454",
          "eventGeneratedDateTime": "2020-02-08T09:30:26Z",
          "registrationId": "9087-978098-9087-978098",
          "reportingSystemSupplier": "SYSTEM_SUPPLIER",
          "reportingPracticeOdsCode": "ABC1234",
          "payload": {
            "registration": {
              "requestingPracticeOdsCode": "ABC1234",
              "sendingPracticeOdsCode": "XYZ4567"
            },
            "gpTransferMetadata": {
              "conversationId": "4345-986959-4930-684038",
              "transferEventDateTime": "2020-02-08T09:30:26Z"
            },
            "structuredRecordMigration": {
              "status": "SUCCESS",
              "reason": ""
            }
          }
        }
        ```
      parameters:
        - in: header
          name: apikey
          description: API key to authenticate with.
          schema:
            type: string
          required: true
      requestBody:
        description: The request body required for the migrate structured record response event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        structuredRecordMigration:
                          $ref: components/schemas/Migration.yaml
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /gpconnect/migrateDocumentRequest:
    post:
      tags:
        - GP Connect
      summary: Submit Migrate document request event
      operationId: migrateDocumentRequest
      description: |
        Use this endpoint to submit GP registration management information immediately after the Requesting System makes an individual request to retrieve each document via GP Connect using the ‘Migrate Document’ end point
        ### Request Body example:
        ```json
        {
          "eventId": "1234-123456-1234-123454",
          "eventGeneratedDateTime": "2020-02-08T09:30:26Z",
          "registrationId": "9087-978098-9087-978098",
          "reportingSystemSupplier": "SYSTEM_SUPPLIER",
          "reportingPracticeOdsCode": "ABC1234",
          "payload": {
            "registration": {
              "requestingPracticeOdsCode": "ABC1234",
              "sendingPracticeOdsCode": "XYZ4567"
            },
            "gpTransferMetadata": {
              "conversationId": "4345-986959-4930-684038",
              "transferEventDateTime": "2020-02-08T09:30:26Z"
            },
            "attachment": {
              "attachmentId": "3424-342456-3424-342456",
              "clinicalType": "Scanned document",
              "mimeType": "application/pdf",
              "sizeBytes": 3084322
            }
          }
        }
        ```
      parameters:
        - in: header
          name: apikey
          description: API key to authenticate with.
          schema:
            type: string
          required: true
      requestBody:
        description: The request body required for the migrate document request event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        attachment:
                          $ref: components/schemas/Attachment.yaml
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /gpconnect/migrateDocumentResponse:
    post:
      tags:
        - GP Connect
      summary: Submit Migrate document response event
      operationId: migrateDocumentResponse
      description: |
        Use this endpoint to submit GP registration management information immediately after the Requesting System receives a response on every individual request to retrieve each document via GP Connect using the ‘Migrate Document’ end point
        ### Request Body example:
        ```json
        {
          "eventId": "1234-123456-1234-123454",
          "eventGeneratedDateTime": "2020-02-08T09:30:26Z",
          "registrationId": "9087-978098-9087-978098",
          "reportingSystemSupplier": "SYSTEM_SUPPLIER",
          "reportingPracticeOdsCode": "ABC1234",
          "payload": {
            "registration": {
              "requestingPracticeOdsCode": "ABC1234",
              "sendingPracticeOdsCode": "XYZ4567"
            },
            "gpTransferMetadata": {
              "conversationId": "4345-986959-4930-684038",
              "transferEventDateTime": "2020-02-08T09:30:26Z"
            },
            "attachment": {
              "attachmentId": "3424-342456-3424-342456",
              "clinicalType": "Scanned document",
              "mimeType": "application/pdf",
              "sizeBytes": 3084322
            },
            "documentMigration": {
              "status": "FAILURE",
              "reason": "Large file size"
            }
          }
        }
        ```
      parameters:
        - in: header
          name: apikey
          description: API key to authenticate with.
          schema:
            type: string
          required: true
      requestBody:
        description: The request body required for the migrate document response event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        attachment:
                          $ref: components/schemas/Attachment.yaml
                        documentMigration:
                          $ref: components/schemas/Migration.yaml
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /gpconnect/ehrReadyToIntegrate:
    post:
      tags:
        - GP Connect
      summary: Submit EHR ready to integrate event
      operationId: ehrReadyToIntegrateGC
      description: |
        Use this endpoint to submit GP registration management information immediately after the Requesting System allows the user to see a pre-processed view of the Record Bundle and all associated documents so they can determine whether to integrate
        ### Request Body example:
        ```json
        {
          "eventId": "1234-123456-1234-123454",
          "eventGeneratedDateTime": "2020-02-08T09:30:26Z",
          "registrationId": "9087-978098-9087-978098",
          "reportingSystemSupplier": "SYSTEM_SUPPLIER",
          "reportingPracticeOdsCode": "ABC1234",
          "payload": {
            "registration": {
              "requestingPracticeOdsCode": "ABC1234",
              "sendingPracticeOdsCode": "XYZ4567"
            },
            "gpTransferMetadata": {
              "conversationId": "4345-986959-4930-684038",
              "transferEventDateTime": "2020-02-08T09:30:26Z"
            },
            "ehr": {
              "degrade": [
                {
                  "type": "core_ehr / attachment",
                  "metadata": "other degrades metadata",
                  "code": {
                    "coding": [
                      {
                        "code": "886721000000107",
                        "system": "http://snomed.info/sct"
                      }
                    ]
                  }
                }
              ]
            }
          }
        }
        ```
      parameters:
        - in: header
          name: apikey
          description: API key to authenticate with.
          schema:
            type: string
          required: true
      requestBody:
        description: The request body required for the EHR ready to integrate event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        ehr:
                          type: object
                          description: An object that contains information about the EHR used in the record transfer
                          properties:
                            degrade:
                              $ref: components/schemas/Degrade.yaml
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /gpconnect/ehrIntegrated:
    post:
      tags:
        - GP Connect
      summary: Submit EHR integrated event
      operationId: ehrIntegratedGC
      description: |
        Use this endpoint to submit GP registration management information immediately after the clinical staff member has chosen to integrate the Patient record into the system.
        ### Request Body example:
        ```json
        {
          "eventId": "1234-123456-1234-123451",
          "eventGeneratedDateTime": "2020-02-08T09:30:26Z",
          "registrationId": "9087-978098-9087-978098",
          "reportingSystemSupplier": "SYSTEM_SUPPLIER",
          "reportingPracticeOdsCode": "ABC1234",
          "payload": {
            "registration": {
              "requestingPracticeOdsCode": "ABC1234",
              "sendingPracticeOdsCode": "XYZ4567"
            },
            "gpTransferMetadata": {
              "conversationId": "4345-986959-4930-684038",
              "transferEventDateTime": "2020-02-08T09:30:26Z"
            },
            "integration": {
              "integrationStatus": "filed as attachment/ suppressed/ merged/ rejected",
              "reason": "Reason for integration status"
            }
          }
        }
        ```
      parameters:
        - in: header
          name: apikey
          description: API key to authenticate with.
          schema:
            type: string
          required: true
      requestBody:
        description: The request body required for the EHR integrated event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        integration:
                          $ref: components/schemas/Integration.yaml
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /gpconnect/registrationCompleted:
    post:
      tags:
        - GP Connect
      summary: Submit Registration Completed event
      operationId: registrationCompletedGC
      description: |
        Use this endpoint to submit GP registration management information once a receiving practice has successfully registered a patient. This should be sent after the EHR integrated event.
        ### Request Body example:
        ```json
        {
          "eventId": "1234-1234-1234-1234",
          "eventGeneratedDateTime": "2020-02-08T09:30:26Z",
          "registrationId": "9087-978098-9087-978098",
          "reportingSystemSupplier": "EMIS",
          "reportingPracticeOdsCode": "ABC1234",
          "payload": {
            "registration": {
              "requestingPracticeOdsCode": "ABC1234",
              "sendingPracticeOdsCode": "XYZ4567"
            },
            "gpTransferMetadata": {
              "conversationId": "4345-986959-4930-684038",
              "transferEventDateTime": "2020-02-08T08:30:25Z"
            }
          }
        }
        ```
      parameters:
        - in: header
          name: apikey
          description: API key to authenticate with.
          schema:
            type: string
          required: true
      requestBody:
        description: The request body required for the registration completed event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /gpconnect/internalTransfer:
    post:
      tags:
        - GP Connect
      summary: Submit internal transfer event
      operationId: internalTransfer
      description: |
        Use this endpoint to submit GP registration management information immediately after a patient transfer has occurred between two practices using the same Supplier System.
        ### Request Body example:
        ```json
        {
          "eventId": "1234-123456-1234-123451",
          "eventGeneratedDateTime": "2020-02-08T09:30:26Z",
          "registrationId": "9087-978098-9087-978098",
          "reportingSystemSupplier": "SYSTEM_SUPPLIER",
          "reportingPracticeOdsCode": "ABC1234",
          "payload": {
            "registration": {
              "requestingPracticeOdsCode": "ABC1234",
              "sendingPracticeOdsCode": "XYZ4567"
            },
            "gpTransferMetadata": {
              "conversationId": "4345-986959-4930-684038",
              "transferEventDateTime": "2020-02-08T09:30:26Z"
            },
            "integration": {
              "integrationStatus": "filed as attachment/ suppressed/ merged/ rejected",
              "reason": "Reason for integration status"
            }
          }
        }
        ```
      parameters:
        - in: header
          name: apikey
          description: API key to authenticate with.
          schema:
            type: string
          required: true
      requestBody:
        description: The request body required for the internal transfer event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        integration:
                          $ref: components/schemas/Integration.yaml
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /gpconnect/error:
    post:
      tags:
        - GP Connect
      summary: Submit error event
      operationId: errorGC
      description: |
        Use this endpoint to submit GP registration management information immediately after an error has occurred, or has been detected by the Supplier System.
        ### Request Body example:
        ```json
        {
          "eventId": "1234-123456-1234-123454",
          "eventGeneratedDateTime": "2020-02-08T09:30:26Z",
          "registrationId": "9087-978098-9087-978098",
          "reportingSystemSupplier": "SYSTEM_SUPPLIER",
          "reportingPracticeOdsCode": "ABC1234",
          "payload": {
            "registration": {
              "requestingPracticeOdsCode": "ABC1234",
              "sendingPracticeOdsCode": "XYZ4567"
            },
            "gpTransferMetadata": {
              "conversationId": "4345-986959-4930-684038",
              "transferEventDateTime": "2020-02-08T09:30:26Z"
            },
            "error": {
              "errorCode": "",
              "errorDescription": "stacktrace? detailed error message?"
            }
          }
        }
        ```
      parameters:
        - in: header
          name: apikey
          description: API key to authenticate with.
          schema:
            type: string
          required: true
      requestBody:
        description: The request body required for the error event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        error:
                          $ref: components/schemas/Error.yaml
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml