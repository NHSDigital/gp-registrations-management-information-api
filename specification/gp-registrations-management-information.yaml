openapi: "3.0.0"
x-nhs-api-spec-guid: 4631c387-3793-4413-8c61-395e014864b2
x-meta:
  service_name: "gp-registrations-management-information"
  short_service_name: "gprmi"
  product_display_name: "GP Registrations Management Information API"
  service_base_path: "gp-registrations-mi"
  product_description: "An API to capture GP Registrations management information (MI)"
  pipeline_name_prefix: "GP-Registrations-Management-Information"
info:
  version: 0.0.1
  title: GP Registrations Management Information API
  description: |
    ## Overview
    Use this API to send real-time management information about GP registrations to us at NHS Digital. As part of the exisitng registration process, a protocol called [GP2GP](https://digital.nhs.uk/developer/api-catalogue/gp2gp) is used to transfer electronic health records (EHR). It consists of multiple messages going back and forth between the software systems of two GP practices - the one sending the electronic health record across and the one receiving the EHR of a patient).
    As the registration process is being updated a new protocol called [GP Connect](https://digital.nhs.uk/developer/api-catalogue/gp-connect-access-record-structured-fhir) will be used to transfer the EHR using a slightly different record migration model.
    This API will receive Management Information from GP practices using either protocol.

    ### GP2GP

    Currently you can send us information about the following type of events:
    * when the requesting practice starts the GP2GP registration - the first message initiated as part of the GP2GP protocol
    * when the sending practice generates the electronic health record
    * when the requesting practice requests an EHR
    * when the sending practice sends an EHR
    
    With upcoming features you will be able to send us information about other type of events, such as (and not exclusively):
    * when the requesting practice validates an EHR
    * when the requesting practice integrates an EHR
    * when the requesting practice has completed the GP2GP registration

    ### GP Connect

    Currently you can send us information about the following type of events:
    * when the requesting practice starts the GP2GP registration - the first message initiated as part of the GP Connect protocol
    * when the request is sent to migrate the structured record
    * when the response has been received from migrating the structured record

    With upcoming features you will be able to send us information about other type of events, such as (and not exclusively):
    * when the request is sent to migrate a document
    * when the response has been received from migrating a document
    * when the EHR is ready to integrate
    * when the EHR has been integrated
    * when the registration has been completed
    * when an internal transfer of an EHR has been completed between to GP practices using the same supplier system
    * when an error occurs

    You cannot:
    * read any management information data submitted to us

    This API replaces the existing weekly submission of GP2GP information sent to us via a MESH mailbox, as required by [GP2GP V2.2b](https://nhsconnect.github.io/prm-external-developer-website/gp2gp/gp2gp_2.2b/overview/).

    ## Who can use this API
    This API can only be used where there is a legal basis to do so. Make sure you have a valid use case before you go too far with your development.
    You must do this before you can go live (see ‘Onboarding’ below). 

    ## Related APIs
    Use [GP2GP - HL7 API](https://digital.nhs.uk/developer/api-catalogue/gp2gp) to learn more the existing GP2GP protocol.

    Use the following to learn more about the newer GP Connect protocol:
    * [GP Connect Access Document - FHIR API](https://digital.nhs.uk/developer/api-catalogue/gp-connect-access-document-fhir)
    * [GP Connect Access Record: HTML - FHIR API](https://digital.nhs.uk/developer/api-catalogue/gp-connect-access-record-html-fhir)
    * [GP Connect Access Record: Structured - FHIR API](https://digital.nhs.uk/developer/api-catalogue/gp-connect-access-record-structured-fhir)
    * [GP Connect Send Document - FHIR API](https://digital.nhs.uk/developer/api-catalogue/gp-connect-send-document-fhir)

    ## API status
    This API is in [alpha](https://digital.nhs.uk/developer/guides-and-documentation/reference-guide#api-status) 

    ## Technology
    This API uses HTTP POST to submit data.

    ## Network access
    This API is only available on the internet. For more details, see [Network access for APIs](https://digital.nhs.uk/developer/guides-and-documentation/network-access-for-apis#internet-only-apis).

    ## Security and authorisation

    The access mode is [application-restricted](https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation#application-restricted-apis),
    meaning we authenticate the calling application but not the end user.
    To use this access mode, use the following security pattern:
    * [Application-restricted RESTful APIs - API key authentication](https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation/application-restricted-restful-apis-api-key-authentication)

    ## Environments and testing

    ### Sandbox testing
    Our [sandbox environment](https://digital.nhs.uk/developer/guides-and-documentation/testing#sandbox-testing) is in development and will be available for you soon.

    ### Integration testing
    Our [integration test environment](https://digital.nhs.uk/developer/guides-and-documentation/testing#integration-testing):
    * is for formal integration testing
    * is for receiving data quality reports of test data

    ## Onboarding
    You need to get your software approved by us before it can go live with this API. We call this onboarding. The onboarding process can sometimes be quite long, so it’s worth planning well ahead. More details on the onboarding process to follow.

  license:
    name: MIT
  contact:
    url: 'https://nhsconnect.github.io/prm-external-developer-website/rfcs/'
    email: ian.griffiths12@nhs.net

tags:
  - name: GP Connect
    description: Endpoints to submit events for the GP Connect protocol
  - name: GP2GP
    description: Endpoints to submit events for the GP2GP protocol

paths:
  /registration/{version}/gp2gp/registrationStarted:
    post:
      tags:
        - GP2GP
      summary: Submit registration started event
      operationId: registrationStarted
      description: |
        Use this endpoint to submit GP registration management information for when a registration is started.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the registration started event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          type: object
                          description: An object that contains information about the registration process
                          properties:
                            registrationType:
                              type: string
                              description: The type of this registration (newRegistrant, etc...)
                            registrationStartedDateTime:
                              type: string
                              description: The ISO 8601 Date time in UTC of when the registration started
                            requestingPracticeOdsCode:
                              type: string
                              description: The ODS code of the practice requesting the EHR
                  example:
                    $ref: components/examples/gp2gp/registrationStarted.json
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /registration/{version}/gp2gp/ehrRequested:
    post:
      tags:
        - GP2GP
      summary: Submit EHR requested event
      operationId: ehrRequested
      description: |
        Use this endpoint to submit GP registration management information for when an Electronic Health Record (EHR) is requested.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the EHR requested event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                  example:
                    $ref: components/examples/gp2gp/ehrRequested.json
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /registration/{version}/gp2gp/ehrGenerated:
    post:
      tags:
        - GP2GP
      summary: Submit EHR generated event
      operationId: ehrGenerated
      description: |
        Use this endpoint to submit GP registration management information for when an Electronic Health Record (EHR) is generated.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the EHR generated event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        ehr:
                          properties:
                            ehrTotalSizeBytes:
                              type: integer
                              description: The total size in bytes of the GP2GP message BEFORE it is split for transfer including all attachments
                            ehrStructuredSizeBytes:
                              type: integer
                              description: The total size in bytes of structured part of the GP2GP message (attachments are NOT to be included)
                            attachment:
                              type: array
                              description: A list that contains information about ALL the attachments contained in the EHR. This should include all attachments that are either directly attached OR that are linked to from within the EHR
                              items:
                                $ref: components/schemas/Attachment.yaml
                            placeholder:
                              type: array
                              description: A list that contains information about the attachments that were in the EHR but not contained in the GP2GP message
                              items:
                                $ref: components/schemas/Placeholder.yaml
                        unSupportedDataItem:
                          type: array
                          items:
                            $ref: components/schemas/UnsupportedDataItem.yaml
                  example:
                    $ref: components/examples/gp2gp/ehrGenerated.json
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /registration/{version}/gp2gp/ehrSent:
    post:
      tags:
        - GP2GP
      summary: Submit EHR sent event
      operationId: ehrSent
      description: |
        Use this endpoint to submit GP registration management information for when an Electronic Health Record (EHR) is sent.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the EHR sent event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                  example:
                    $ref: components/examples/gp2gp/ehrSent.json
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /registration/{version}/gp2gp/ehrValidated:
    post:
      tags:
        - GP2GP
      summary: Submit EHR validated event
      operationId: ehrValidated
      description: |
        Use this endpoint to submit GP registration management information for when an Electronic Health Record (EHR) is validated.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the EHR validated event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        ehr:
                          properties:
                            ehrTotalSizeBytes:
                              type: integer
                              description: The total size in bytes of the GP2GP message as reconstituted by the receiving system including all attachments received
                            ehrStructuredSizeBytes:
                              type: integer
                              description: The total size in bytes of structured part of the GP2GP message as received by the receiving system (attachments are NOT to be included)
                            attachment:
                              type: array
                              description: A list that contains information about ALL the attachments contained in the EHR. This should include all attachments that are either directly attached OR that are linked to from within the EHR
                              items:
                                $ref: components/schemas/Attachment.yaml
                            placeholder:
                              type: array
                              description: A list that contains information about the attachments that were in the EHR but not contained in the GP2GP message
                              items:
                                $ref: components/schemas/Placeholder.yaml
                            degrade:
                              type: array
                              description: A list that contains information about ALL the degrades contained in the EHR that occurred due to the gp2gp transfer
                              items:
                                $ref: components/schemas/Degrade.yaml
                  example:
                    $ref: components/examples/gp2gp/ehrValidated.json
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /registration/{version}/gp2gp/ehrIntegrated:
    post:
      tags:
        - GP2GP
      summary: Submit EHR integrated event
      operationId: ehrIntegrated
      description: |
        Use this endpoint to submit GP registration management information for when an Electronic Health Record (EHR) is integrated.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the EHR integrated event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        integration:
                          $ref: components/schemas/Integration.yaml
                  example:
                    $ref: components/examples/gp2gp/ehrIntegrated.json
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /registration/{version}/gp2gp/registrationCompleted:
    post:
      tags:
        - GP2GP
      summary: Submit Registration Completed event
      operationId: registrationCompleted
      description: |
        Use this endpoint to submit GP registration management information for when a GP2GP registration is complete.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the registration completed event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                  example:
                    $ref: components/examples/gp2gp/registrationCompleted.json
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /registration/{version}/gpconnect/registrationStarted:
    post:
      tags:
        - GP Connect
      summary: Submit registration event
      operationId: registrationStartedGC
      description: |
        Use this endpoint to submit GP registration management information for when a registration is started.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the registration started event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          type: object
                          description: An object that contains information about the registration process
                          properties:
                            registrationType:
                              type: string
                              description: The type of this registration (newRegistrant, etc...)
                            registrationStartedDateTime:
                              type: string
                              description: The ISO 8601 Date time in UTC of when the registration started
                            requestingPracticeOdsCode:
                              type: string
                              description: The ODS code of the practice requesting the EHR
                  example:
                    $ref: components/examples/gpconnect/registrationStarted.json
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /registration/{version}/gpconnect/migrateStructuredRecordRequest:
    post:
      tags:
        - GP Connect
      summary: Submit Migrate Structured Record Request event
      operationId: migrateStructuredRecordRequest
      description: |
        Use this endpoint to submit GP registration management information immediately after the Requesting System will make a request via GP Connect using the ‘Migrate Structured Record’ end point using the previous Health Care Provider code that was cached
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the migrate structured record request event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                  example:
                    $ref: components/examples/gpconnect/migrateStructuredRecordRequest.json
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /registration/{version}/gpconnect/migrateStructuredRecordResponse:
    post:
      tags:
        - GP Connect
      summary: Submit Migrate Structured Record response event
      operationId: migrateStructuredRecordResponse
      description: |
        Use this endpoint to submit GP registration management information immediately after the Requesting System has received a response from the request made via GP Connect using the ‘Migrate Structured Record’ end point. In a happy-path scenario, the response should contain the "Migrate Patient Record Bundle"
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the migrate structured record response event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        structuredRecordMigration:
                          $ref: components/schemas/Migration.yaml
                  example:
                    $ref: components/examples/gpconnect/migrateStructuredRecordResponse.json
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /registration/{version}/gpconnect/migrateDocumentRequest:
    post:
      tags:
        - GP Connect
      summary: Submit Migrate document request event
      operationId: migrateDocumentRequest
      description: |
        Use this endpoint to submit GP registration management information immediately after the Requesting System makes an individual request to retrieve each document via GP Connect using the ‘Migrate Document’ end point
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the migrate document request event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        attachment:
                          $ref: components/schemas/Attachment.yaml
                  example:
                    $ref: components/examples/gpconnect/migrateDocumentRequest.json
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /registration/{version}/gpconnect/migrateDocumentResponse:
    post:
      tags:
        - GP Connect
      summary: Submit Migrate document response event
      operationId: migrateDocumentResponse
      description: |
        Use this endpoint to submit GP registration management information immediately after the Requesting System receives a response on every individual request to retrieve each document via GP Connect using the ‘Migrate Document’ end point
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the migrate document response event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        attachment:
                          $ref: components/schemas/Attachment.yaml
                        documentMigration:
                          $ref: components/schemas/Migration.yaml
                  example:
                    $ref: components/examples/gpconnect/migrateDocumentResponse.json
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /registration/{version}/gpconnect/ehrReadyToIntegrate:
    post:
      tags:
        - GP Connect
      summary: Submit EHR ready to integrate event
      operationId: ehrReadyToIntegrateGC
      description: |
        Use this endpoint to submit GP registration management information immediately after the Requesting System allows the user to see a pre-processed view of the Record Bundle and all associated documents so they can determine whether to integrate
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the EHR ready to integrate event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        ehr:
                          type: object
                          description: An object that contains information about the EHR used in the record transfer
                          properties:
                            degrade:
                              $ref: components/schemas/Degrade.yaml
                  example:
                    $ref: components/examples/gpconnect/ehrReadyToIntegrate.json

      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /registration/{version}/gpconnect/ehrIntegrated:
    post:
      tags:
        - GP Connect
      summary: Submit EHR integrated event
      operationId: ehrIntegratedGC
      description: |
        Use this endpoint to submit GP registration management information immediately after the clinical staff member has chosen to integrate the Patient record into the system.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the EHR integrated event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        integration:
                          $ref: components/schemas/Integration.yaml
                  example:
                    $ref: components/examples/gpconnect/ehrIntegrated.json
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /registration/{version}/gpconnect/registrationCompleted:
    post:
      tags:
        - GP Connect
      summary: Submit Registration Completed event
      operationId: registrationCompletedGC
      description: |
        Use this endpoint to submit GP registration management information once a receiving practice has successfully registered a patient. This should be sent after the EHR integrated event.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the registration completed event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                  example:
                    $ref: components/examples/gpconnect/registrationCompleted.json
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /registration/{version}/gpconnect/internalTransfer:
    post:
      tags:
        - GP Connect
      summary: Submit internal transfer event
      operationId: internalTransfer
      description: |
        Use this endpoint to submit GP registration management information immediately after a patient transfer has occurred between two practices using the same Supplier System.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the internal transfer event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        integration:
                          $ref: components/schemas/Integration.yaml
                  example:
                    $ref: components/examples/gpconnect/internalTransfer.json
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml

  /registration/{version}/gpconnect/error:
    post:
      tags:
        - GP Connect
      summary: Submit error event
      operationId: errorGC
      description: |
        Use this endpoint to submit GP registration management information immediately after an error has occurred, or has been detected by the Supplier System.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the error event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: ./components/schemas/BaseEvent.yaml
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: components/schemas/Registration.yaml
                        gpTransferMetadata:
                          $ref: components/schemas/GPTransferMetadata.yaml
                        error:
                          $ref: components/schemas/Error.yaml
                  example:
                    $ref: components/examples/gpconnect/error.json
      responses:
        '200':
          $ref: components/responses/OK.yaml
        '400':
          $ref: components/responses/BadRequest.yaml
        '500':
          $ref: components/responses/InternalServerError.yaml