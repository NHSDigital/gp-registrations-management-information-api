openapi: "3.0.0"
x-nhs-api-spec-guid: 4631c387-3793-4413-8c61-395e014864b2
x-meta:
  service_name: "gp-registrations-management-information"
  short_service_name: "gprmi"
  product_display_name: "GP Registrations Management Information API"
  service_base_path: "gp-registrations-mi"
  product_description: "An API to capture GP Registrations management information (MI)"
  pipeline_name_prefix: "GP-Registrations-Management-Information"
info:
  version: 0.0.1
  title: GP Registrations Management Information API
  description: |
    ## Overview
    Use this API to send real-time management information about GP registrations to us at NHS Digital. As part of the exisitng registration process, a protocol called [GP2GP](https://digital.nhs.uk/developer/api-catalogue/gp2gp) is used to transfer electronic health records (EHR). It consists of multiple messages going back and forth between the software systems of two GP practices - the one sending the electronic health record across and the one receiving the EHR of a patient).
    As the registration process is being updated a new protocol called [GP Connect](https://digital.nhs.uk/developer/api-catalogue/gp-connect-access-record-structured-fhir) will be used to transfer the EHR using a slightly different record migration model.
    This API will receive Management Information from GP practices using either protocol.

    ### GP2GP

    Currently you can send us information about the following type of events:
    * when the requesting practice starts the GP2GP registration - the first message initiated as part of the GP2GP protocol
    * when the sending practice generates the electronic health record
    * when the requesting practice requests an EHR
    * when the sending practice sends an EHR
    
    With upcoming features you will be able to send us information about other type of events, such as (and not exclusively):
    * when the requesting practice validates an EHR
    * when the requesting practice integrates an EHR
    * when the requesting practice has completed the GP2GP registration

    ### GP Connect

    Currently you can send us information about the following type of events:
    * when the requesting practice starts the GP2GP registration - the first message initiated as part of the GP Connect protocol
    * when the request is sent to migrate the structured record
    * when the response has been received from migrating the structured record

    With upcoming features you will be able to send us information about other type of events, such as (and not exclusively):
    * when the request is sent to migrate a document
    * when the response has been received from migrating a document
    * when the EHR is ready to integrate
    * when the EHR has been integrated
    * when the registration has been completed
    * when an internal transfer of an EHR has been completed between to GP practices using the same supplier system
    * when an error occurs

    You cannot:
    * read any management information data submitted to us

    This API replaces the existing weekly submission of GP2GP information sent to us via a MESH mailbox, as required by [GP2GP V2.2b](https://nhsconnect.github.io/prm-external-developer-website/gp2gp/gp2gp_2.2b/overview/).

    ## Who can use this API
    This API can only be used where there is a legal basis to do so. Make sure you have a valid use case before you go too far with your development.
    You must do this before you can go live (see ‘Onboarding’ below). 

    ## Related APIs
    Use [GP2GP - HL7 API](https://digital.nhs.uk/developer/api-catalogue/gp2gp) to learn more the existing GP2GP protocol.

    Use the following to learn more about the newer GP Connect protocol:
    * [GP Connect Access Document - FHIR API](https://digital.nhs.uk/developer/api-catalogue/gp-connect-access-document-fhir)
    * [GP Connect Access Record: HTML - FHIR API](https://digital.nhs.uk/developer/api-catalogue/gp-connect-access-record-html-fhir)
    * [GP Connect Access Record: Structured - FHIR API](https://digital.nhs.uk/developer/api-catalogue/gp-connect-access-record-structured-fhir)
    * [GP Connect Send Document - FHIR API](https://digital.nhs.uk/developer/api-catalogue/gp-connect-send-document-fhir)

    ## API status
    This API is in [alpha](https://digital.nhs.uk/developer/guides-and-documentation/reference-guide#api-status) 

    ## Technology
    This API uses HTTP POST to submit data.

    ## Network access
    This API is only available on the internet. For more details, see [Network access for APIs](https://digital.nhs.uk/developer/guides-and-documentation/network-access-for-apis#internet-only-apis).

    ## Security and authorisation

    The access mode is [application-restricted](https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation#application-restricted-apis),
    meaning we authenticate the calling application but not the end user.
    To use this access mode, use the following security pattern:
    * [Application-restricted RESTful APIs - API key authentication](https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation/application-restricted-restful-apis-api-key-authentication)

    ## Environments and testing

    ### Sandbox testing
    Our [sandbox environment](https://digital.nhs.uk/developer/guides-and-documentation/testing#sandbox-testing) is in development and will be available for you soon.

    ### Integration testing
    Our [integration test environment](https://digital.nhs.uk/developer/guides-and-documentation/testing#integration-testing):
    * is for formal integration testing
    * is for receiving data quality reports of test data

    ## Onboarding
    You need to get your software approved by us before it can go live with this API. We call this onboarding. The onboarding process can sometimes be quite long, so it’s worth planning well ahead. More details on the onboarding process to follow.

  license:
    name: MIT
  contact:
    url: 'https://nhsconnect.github.io/prm-external-developer-website/rfcs/'
    email: ian.griffiths12@nhs.net

components:
  schemas:
    BaseEvent:
      type: object
      required:
        - eventId
        - eventGeneratedDateTime
        - registrationId
        - reportingSystemSupplier
        - reportingPracticeOdsCode
      properties:
        eventId:
          type: string
          description: Unique identifier for this event
          format: uuid
          minLength: 16
          maxLength: 16
        eventGeneratedDateTime:
          type: string
          description: The ISO 8601 Date time in UTC of when this MI event was generated by the system
          format: date-time
        registrationId:
          type: string
          description: The unique identifier for this registration that can be resolved in the clinical system
        reportingSystemSupplier:
          type: string
          description: The system supplier who generated the event. A unique identifier given to you as a supplier by NHSD
        reportingPracticeOdsCode:
          type: string
          description: The ODS code of the practice generating this event
      example:
        eventId: 1234-1234-1234-1234
        eventGeneratedDateTime: 2020-02-08T09:30:26Z
        registrationId: 6235-123456-8947-127834
        reportingSystemSupplier: supplierOne
        reportingPracticeOdsCode: ABC1234
    Registration:
      type: object
      required:
        - requestingPracticeOdsCode
        - sendingPracticeOdsCode
      properties:
        requestingPracticeOdsCode:
          type: string
          description: The ODS code of the practice requesting the EHR
        sendingPracticeOdsCode:
          type: string
          description: The ODS code of the practice sending the EHR
      example:
        requestingPracticeOdsCode: ABC1234
        sendingPracticeOdsCode: XYZ4567
    GP Transfer Metadata:
      type: object
      required:
        - conversationId
        - transferEventDateTime
      properties:
        conversationId:
          type: string
          description: The ConversationID used in the GP2GP process for this registration
        transferEventDateTime:
          type: string
          description: The ISO 8601 Date time in UTC that this patient transfer event occurred
          format: date-time
      example:
        conversationId: 4345-9869-4930-6840
        transferEventDateTime: 2020-02-08T08:30:26Z
    Attachment:
      type: object
      required:
        - attachmentId
        - mimeType
        - sizeBytes
      properties:
        attachmentId:
          type: string
          description: A unique id for the attachment that can be resolved in the clinical system
        clinicalType:
          type: string
          description: The text value corresponding to the value used in EhrAttachmentCode in the code element of ExternalDocument as defined in the MIM
        mimeType:
          type: string
          description: The mime type of the attachment as used as part of the text element in ExternalDocument as defined in the MIM
        sizeBytes:
          type: integer
          description: The size in bytes of the attachment
      example:
        attachmentId: 3424-342456-3424-342456
        clinicalType: Scanned document
        mimeType: application/pdf
        sizeBytes: 3084322
    Placeholder:
      type: object
      required:
        - placeholderId
        - attachmentId
        - generatedBy
        - reason
        - originalMimeType
      properties:
        placeholderId:
          type: string
          description: A unique id for the placeholder that can be resolved in the clinical system
        attachmentId:
          type: string
          description: A reference to the attachment that the placeholder replaces (should be contained in the list of attachments)
        generatedBy:
          type: string
          description: The ODS code of the practice that generated the placeholder
        reason:
          type: integer
          description: The reason the placeholder was generated. These codes should match the values described in [NPFIT-PC-BLD-0099.04 GP2GP Handling Missing Attachments](https://nhsconnect.github.io/prm-external-developer-website/NPFIT-PC-BLD-0099.04%20GP2GP%20Handling%20Missing%20Attachments.pdf)
        originalMimeType:
          type: string
          description: The original mime type of the attachment this placeholder is for
      example:
        placeholderId: 9876-987654-9876-987654
        attachmentId: 1323-132345-1323-132345
        generatedBy: XYZ4567
        reason: 1
        originalMimeType: audio/mpeg
    UnsupportedDataItem:
      type: object
      required:
        - type
        - uniqueIdentifier
        - reason
      properties:
        type:
          type: string
          description: The type/category of the unsupported data item
        uniqueIdentifier:
          type: string
          description: A unique id for the unsupported data item that can be resolved in the clinical system
        reason:
          type: string
          description: The reason for being unsupported / why is it unsupported in gp2gp? / what would have to change in gp2gp to express this?
      example:
        type: allergy/flag
        uniqueIdentifier: 1323-132345-1323-132345
        reason: Doesn't map properly
    Degrade:
      type: object
      required:
        - type
        - metadata
        - code
      properties:
        type:
          type: string
          description: The type/category of this degrade
        metadata:
          type: string
          description: Any additional metadata that provides valuable intel on this degrade
        code:
          type: object
          properties:
            coding:
              type: array
              items:
                properties:
                  code:
                    type: string
                    description: The designated code for this particular degrade
                  system:
                    type: string
                    description: The system in which this degrade occurred
      example:
        type: core_ehr / attachment
        metadata: other degrades metadata
        code:
          coding:
            - code: 886721000000107
              system: http://snomed.info/sct
    Integration:
      type: object
      required:
        - integrationStatus
        - reason
      properties:
        integrationStatus:
          type: string
          description: The status of this integration, (filed as attachment/ suppressed/ merged/ rejected)
        reason:
          type: string
          description: The reason for this integration status
      example:
        integrationStatus: filed as attachment/ suppressed/ merged/ rejected
        reason: Reason for integration status
    Error:
      type: object
      properties:
        status:
          type: string
        message:
          type: string
        errors:
          type: array
          items:
            type: string
      required:
        - status
        - message
        - errors
  responses:
    OK:
      description: OK. Expected response to a valid request
      content:
        application/json:
          schema:
            type: object
            properties:
              eventId:
                type: string
                example: 1234-1234-1234-1234
    BadRequest:
      description: Bad request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    InternalServerError:
      description: Internal server error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'


tags:
  - name: GP2GP
    description: Endpoints to submit events for the GP2GP protocol
  - name: GP Connect
    description: Endpoints to submit events for the GP Connect protocol

paths:
  /registration/{version}/gp2gp/registrationStarted:
    post:
      tags:
        - GP2GP
      summary: Submit registration event
      operationId: postData
      description: |
        Use this endpoint to submit GP registration management information for when a registration is started.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the registration started event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseEvent'
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          type: object
                          description: An object that contains information about the registration process
                          properties:
                            registrationType:
                              type: string
                              description: The type of this registration (newRegistrant, etc...)
                            registrationStartedDateTime:
                              type: string
                              description: The ISO 8601 Date time in UTC of when the registration started
                            requestingPracticeOdsCode:
                              type: string
                              description: The ODS code of the practice requesting the EHR
                  example:
                    payload:
                      registration:
                        registrationType: newRegistrant
                        requestingPracticeOdsCode: ABC1234
                        registrationStartedDateTime: 2020-02-08T08:30:26Z
      responses:
        '200':
          $ref: '#/components/responses/OK'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /registration/{version}/gp2gp/ehrRequested:
    post:
      tags:
        - GP2GP
      summary: Submit EHR requested event
      operationId: postData
      description: |
        Use this endpoint to submit GP registration management information for when an Electronic Health Record (EHR) is requested.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the EHR requested event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseEvent'
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: '#/components/schemas/Registration'
                        gpTransferMetadata:
                          $ref: '#/components/schemas/GP Transfer Metadata'
                  example:
                    payload:
                      registration:
                        requestingPracticeOdsCode: ABC1234
                        sendingPracticeOdsCode: XYZ4567
                      gpTransferMetadata:
                        conversationId: 4345-9869-4930-6840
                        transferEventDateTime: 2020-02-08T08:30:26Z
      responses:
        '200':
          $ref: '#/components/responses/OK'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /registration/{version}/gp2gp/ehrGenerated:
    post:
      tags:
        - GP2GP
      summary: Submit EHR generated event
      operationId: postData
      description: |
        Use this endpoint to submit GP registration management information for when an Electronic Health Record (EHR) is generated.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the EHR generated event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseEvent'
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: '#/components/schemas/Registration'
                        gpTransferMetadata:
                          $ref: '#/components/schemas/GP Transfer Metadata'
                        ehr:
                          properties:
                            ehrTotalSizeBytes:
                              type: integer
                              description: The total size in bytes of the GP2GP message BEFORE it is split for transfer including all attachments
                            ehrStructuredSizeBytes:
                              type: integer
                              description: The total size in bytes of structured part of the GP2GP message (attachments are NOT to be included)
                            attachment:
                              type: array
                              description: A list that contains information about ALL the attachments contained in the EHR. This should include all attachments that are either directly attached OR that are linked to from within the EHR
                              items:
                                $ref: '#/components/schemas/Attachment'
                            placeholder:
                              type: array
                              description: A list that contains information about the attachments that were in the EHR but not contained in the GP2GP message
                              items:
                                $ref: '#/components/schemas/Placeholder'
                        unSupportedDataItem:
                          type: array
                          items:
                            $ref: '#/components/schemas/UnsupportedDataItem'

                  example:
                    payload:
                      registration:
                        requestingPracticeOdsCode: ABC1234
                        sendingPracticeOdsCode: XYZ4567
                      gpTransferMetadata:
                        conversationId: 4345-9869-4930-6840
                        transferEventDateTime: 2020-02-08T08:30:26Z
                      ehr:
                        ehrTotalSizeBytes: 5699433
                        ehrStructuredSizeBytes: 4096
                        attachment:
                          - attachmentId: 3424-342456-3424-342456
                            clinicalType: Scanned document
                            mimeType: application/pdf
                            sizeBytes: 3084322
                          - attachmentId: 1323-132345-1323-132345
                            mimeType: audio/mpeg
                            sizeBytes: 24352346
                        placeholder:
                          - placeholderId: 9876-987654-9876-987654
                            attachmentId: 1323-132345-1323-132345
                            generatedBy: XYZ4567
                            reason: 1
                            originalMimeType: audio/mpeg
                      unsupportedDataItem:
                        - type: allergy/flag
                          uniqueIdentifier: 1323-132345-1323-132345
                          reason: Doesn't map properly
      responses:
        '200':
          $ref: '#/components/responses/OK'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /registration/{version}/gp2gp/ehrSent:
    post:
      tags:
        - GP2GP
      summary: Submit EHR sent event
      operationId: postData
      description: |
        Use this endpoint to submit GP registration management information for when an Electronic Health Record (EHR) is sent.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the EHR sent event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseEvent'
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: '#/components/schemas/Registration'
                        gpTransferMetadata:
                          $ref: '#/components/schemas/GP Transfer Metadata'
                  example:
                    payload:
                      registration:
                        requestingPracticeOdsCode: ABC1234
                        sendingPracticeOdsCode: XYZ4567
                      gpTransferMetadata:
                        conversationId: 4345-9869-4930-6840
                        transferEventDateTime: 2020-02-08T08:30:26Z
      responses:
        '200':
          $ref: '#/components/responses/OK'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /registration/{version}/gp2gp/ehrValidated:
    post:
      tags:
        - GP2GP
      summary: Submit EHR validated event
      operationId: postData
      description: |
        Use this endpoint to submit GP registration management information for when an Electronic Health Record (EHR) is validated.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the EHR validated event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseEvent'
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: '#/components/schemas/Registration'
                        gpTransferMetadata:
                          $ref: '#/components/schemas/GP Transfer Metadata'
                        ehr:
                          properties:
                            ehrTotalSizeBytes:
                              type: integer
                              description: The total size in bytes of the GP2GP message as reconstituted by the receiving system including all attachments received
                            ehrStructuredSizeBytes:
                              type: integer
                              description: The total size in bytes of structured part of the GP2GP message as received by the receiving system (attachments are NOT to be included)
                            attachment:
                              type: array
                              description: A list that contains information about ALL the attachments contained in the EHR. This should include all attachments that are either directly attached OR that are linked to from within the EHR
                              items:
                                $ref: '#/components/schemas/Attachment'
                            placeholder:
                              type: array
                              description: A list that contains information about the attachments that were in the EHR but not contained in the GP2GP message
                              items:
                                $ref: '#/components/schemas/Placeholder'
                            degrade:
                              type: array
                              description: A list that contains information about ALL the degrades contained in the EHR that occurred due to the gp2gp transfer
                              items:
                                $ref: '#/components/schemas/Degrade'

                  example:
                    payload:
                      registration:
                        requestingPracticeOdsCode: ABC1234
                        sendingPracticeOdsCode: XYZ4567
                      gpTransferMetadata:
                        conversationId: 4345-9869-4930-6840
                        transferEventDateTime: 2020-02-08T08:30:26Z
                      ehr:
                        ehrTotalSizeBytes: 5699433
                        ehrStructuredSizeBytes: 4096
                        attachment:
                          - attachmentId: 3424-342456-3424-342456
                            clinicalType: Scanned document
                            mimeType: application/pdf
                            sizeBytes: 3084322
                          - attachmentId: 1323-132345-1323-132345
                            mimeType: audio/mpeg
                            sizeBytes: 24352346
                        placeholder:
                          - placeholderId: 9876-987654-9876-987654
                            attachmentId: 1323-132345-1323-132345
                            generatedBy: XYZ4567
                            reason: 1
                            originalMimeType: audio/mpeg
                        degrade:
                          - type: core_ehr / attachment
                            metadata: other degrades metadata
                            code:
                              coding:
                                - code: 886721000000107
                                  system: http://snomed.info/sct
      responses:
        '200':
          $ref: '#/components/responses/OK'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /registration/{version}/gp2gp/ehrIntegrated:
    post:
      tags:
        - GP2GP
      summary: Submit EHR integrated event
      operationId: postData
      description: |
        Use this endpoint to submit GP registration management information for when an Electronic Health Record (EHR) is integrated.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the EHR integrated event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseEvent'
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: '#/components/schemas/Registration'
                        gpTransferMetadata:
                          $ref: '#/components/schemas/GP Transfer Metadata'
                        integration:
                          $ref: '#/components/schemas/Integration'
                  example:
                    payload:
                      registration:
                        requestingPracticeOdsCode: ABC1234
                        sendingPracticeOdsCode: XYZ4567
                      gpTransferMetadata:
                        conversationId: 4345-9869-4930-6840
                        transferEventDateTime: 2020-02-08T08:30:26Z
                      integration:
                        integrationStatus: filed as attachment/ suppressed/ merged/ rejected
                        reason: Reason for integration status
      responses:
        '200':
          $ref: '#/components/responses/OK'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /registration/{version}/gp2gp/registrationComplete:
    post:
      tags:
        - GP2GP
      summary: Submit Registration Complete event
      operationId: postData
      description: |
        Use this endpoint to submit GP registration management information for when a GP2GP registration is complete.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the registration complete event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseEvent'
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: '#/components/schemas/Registration'
                        gpTransferMetadata:
                          $ref: '#/components/schemas/GP Transfer Metadata'
                  example:
                    payload:
                      registration:
                        requestingPracticeOdsCode: ABC1234
                        sendingPracticeOdsCode: XYZ4567
                      gpTransferMetadata:
                        conversationId: 4345-9869-4930-6840
                        transferEventDateTime: 2020-02-08T08:30:26Z
      responses:
        '200':
          $ref: '#/components/responses/OK'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /registration/{version}/gpconnect/registrationStarted:
    post:
      tags:
        - GP Connect
      summary: Submit registration event
      operationId: postData
      description: |
        Use this endpoint to submit GP registration management information for when a registration is started.
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the registration started event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseEvent'
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          type: object
                          description: An object that contains information about the registration process
                          properties:
                            registrationType:
                              type: string
                              description: The type of this registration (newRegistrant, etc...)
                            registrationStartedDateTime:
                              type: string
                              description: The ISO 8601 Date time in UTC of when the registration started
                            requestingPracticeOdsCode:
                              type: string
                              description: The ODS code of the practice requesting the EHR
                  example:
                    payload:
                      registration:
                        registrationType: newRegistrant
                        requestingPracticeOdsCode: ABC1234
                        registrationStartedDateTime: 2020-02-08T08:30:26Z
      responses:
        '200':
          $ref: '#/components/responses/OK'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'

  /registration/{version}/gpconnect/migrateStructuredRecordRequest:
    post:
      tags:
        - GP Connect
      summary: Submit Migrate Structured Record Request event
      operationId: postData
      description: |
        Use this endpoint to submit GP registration management information immediately after the Requesting System will make a request via GP Connect using the ‘Migrate Structured Record’ end point using the previous Health Care Provider code that was cached
      parameters:
        - name: version
          in: path
          required: true
          description: The API version, currently v1
          schema:
            type: string
      requestBody:
        description: The request body required for the migrate structured record request event
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseEvent'
                - type: object
                  required:
                    - payload
                  properties:
                    payload:
                      description: An object that contains the detailed payload of the event
                      type: object
                      properties:
                        registration:
                          $ref: '#/components/schemas/Registration'
                        gpTransferMetadata:
                          $ref: '#/components/schemas/GP Transfer Metadata'
                  example:
                    payload:
                      registration:
                        requestingPracticeOdsCode: ABC1234
                        sendingPracticeOdsCode: XYZ4567
                      gpTransferMetadata:
                        conversationId: 4345-9869-4930-6840
                        transferEventDateTime: 2020-02-08T08:30:26Z
      responses:
        '200':
          $ref: '#/components/responses/OK'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'